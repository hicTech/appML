<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>appML</title>

<link href="packaging/favicon.ico" rel="shortcut icon">
<meta content="yes" name="apple-mobile-web-app-capable">
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<!-- iPhone ICON -->
<link href="packaging/apple-touch-icon-57x57.png" sizes="57x57" rel="apple-touch-icon-precomposed">
<!-- iPad ICON-->
<link href="packaging/apple-touch-icon-72x72.png" sizes="72x72" rel="apple-touch-icon-precomposed">
<!-- iPhone (Retina) ICON-->
<link href="packaging/apple-touch-icon-114x114.png" sizes="114x114" rel="apple-touch-icon-precomposed">
<!-- iPad (Retina) ICON-->
<link href="packaging/apple-touch-icon-144x144.png" sizes="144x144" rel="apple-touch-icon-precomposed">

<!-- iPhone SPLASHSCREEN-->
<link href="packaging/iPhone/apple-touch-startup-image-320x460.png" media="(device-width: 320px)" rel="apple-touch-startup-image">
<!-- iPhone (Retina) SPLASHSCREEN-->
<link href="packaging/iPhone-retina/apple-touch-startup-image-320x460.png" media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
<!-- iPad (portrait) SPLASHSCREEN-->
<link href="packaging/iPad-portrait/apple-touch-startup-image-768x1004.png" media="(device-width: 768px) and (orientation: portrait)" rel="apple-touch-startup-image">
<!-- iPad (landscape) SPLASHSCREEN-->
<link href="packaging/iPad-landscape/apple-touch-startup-image-748x1024.png" media="(device-width: 768px) and (orientation: landscape)" rel="apple-touch-startup-image">

<!-- css CORE -->
<link rel="stylesheet" href="css/general/appML.css"/>

<!-- css VOSTRO di libreria -->
<style type="text/css" media="all">@import "css/themes/ht/theme.css";</style>

<script type="text/javascript" charset="utf-8" src="js/jquery/jquery-1.7.1-appMLversion.js"></script>
<script type="text/javascript" charset="utf-8" src="js/plugins/livequery/jquery.livequery-1.0.3.js"></script>

<!-- MODULES & CONF -->
<script type="text/javascript" charset="utf-8" src="js/hicTech/modules.js"></script>
<script type="text/javascript" charset="utf-8" src="js/hicTech/appMLconf.js"></script>

<!-- Plugins -->
<script type="text/javascript" charset="utf-8" src="js/plugins/add2home/add2home.js"></script>
<script type="text/javascript" charset="utf-8" src="js/plugins/_.js"></script>
<script type="text/javascript" charset="utf-8" src="js/plugins/spin.js"></script>
<link rel="stylesheet" href="js/plugins/jmap2.1/mapStyle.css" type="text/css" media="screen" /> 

<script src="http://maps.google.com/maps/api/js?v=3.3&amp;sensor=false" type="text/javascript"></script> 
<script src="js/plugins/jmap2.1/markermanager.js" type="text/javascript"></script> 
<script src="js/plugins/jmap2.1/StyledMarker.js" type="text/javascript"></script> 
<script src="js/plugins/jmap2.1/jquery.metadata.js" type="text/javascript"></script> 
<script src="js/plugins/jmap2.1/jquery.jmapping.js" type="text/javascript"></script>

<!-- appManager -->
<script type="text/javascript" charset="utf-8" src="js/hicTech/appManager.js"></script>




<script>

function appMLReady() {
	

	
	var scrollableRegister = new Array();
	
	$("#appML_content").find(".appML_page:visible").livequery(function(){
		var id = $(this).attr("id");
		if(appMLconf.forcedStartingPage){
			setTimeout(function(){
				animateContentPage();
				executeAutomaticScroll(id);
			},1300)
		}
		else{
			automaticScroll(id);
		}
	})
	
	
	if(appML.getEnviroment().isIDevice){
		$("ul.arrow_list li").bind("tap",function(){
			var id = $(this).attr("data-page-link");
			automaticScroll(id);
		})
	}
	else{
		$("ul.arrow_list li").click(function(){
			var id = $(this).attr("data-page-link");
			automaticScroll(id);
		})
	}
	

	
	function automaticScroll(page_id){
		
		if ( !_.include(scrollableRegister, page_id) ){
			appML.appManagerShowLoading();
			
			
			setTimeout(function(){
				executeAutomaticScroll(page_id)
				setTimeout(function(){
					appML.goTo("#"+page_id);
					animateContentPage();
				},150);
				setTimeout(function(){
					appML.appManagerHideLoading();
				},800);
			},350);	
		}
		else{
			appML.goTo("#"+page_id);
		}
	}
	
	function animateContentPage(){
		var $page = appML.getCurrentPage();
		downloadImages($page);
		bindButtonClick($page);
		executeAutomaticCarousel($page);
		executeAutomaticMap($page);
	}
	
	function executeAutomaticScroll(page_id){
		var $dynamic_scroll_container = $("#"+page_id).find(".dynamic_scroll_container");
		if(! $dynamic_scroll_container.is(".not_scrollable")){
			appML.scrollable($dynamic_scroll_container ,"null", appML.getPageWidth(), appML.getPageHeight());
			scrollableRegister.push(page_id);
		}
		
	}
	
	function executeAutomaticCarousel($elem){
		var caros = $elem.find(".auto_Carousel");
		appML.makeCarousel(caros);
		$elem.find("li").show();
	}
	
	
	
	function executeAutomaticMap($elem){
		$elem_map = $elem.find(".automatic_mapContainer");
		var id = $elem_map.attr("data-id");
		$elem_map.css("width", appML.getPageWidth());
		$elem_map.css("height", appML.getPageHeight())
		$elem_map.css("top", "0px");
		$elem_map.css("left", "0px");
		var map = $elem_map.jMapping({
						
					    category_icon_options: function(category){
					    						
										      if (category=="expo"){
										        return new google.maps.MarkerImage('jmap2.1/markers/expo.png');
										      }
										      else
											     return new google.maps.MarkerImage('jmap2.1/markers/attivita.png');
						},
						side_bar_selector: '#side-bar-map-risultati_'+id,
						//location_selector: '.location-risultati',
						//link_selector: 'a.map-item-risultati',
						//info_window_selector: '.info-html-risultati',
						map_config: {
						      navigationControlOptions: {
						        style: google.maps.NavigationControlStyle.DEFAULT,
						      },
						      mapTypeControl: false,
						      mapTypeId: google.maps.MapTypeId.ROADMAP
    					}
    					
  					});
	}
	
	function bindButtonClick($elem){
		
		$elem_button = $elem.find(".whiteButton");
		
		var linked_page = $elem_button.attr("data-linked_page_id");
		if(appML.getEnviroment().isIDevice){
			$elem_button.bind("tap",function(){
				appML.goTo("#"+linked_page,"flip");
			})
		}
		else{
			$elem_button.click(function(){
				appML.goTo("#"+linked_page,"slide");
			})
		}
		
	}

	function downloadImages($elem){
		$elem.find("img").each(function(){
			if($(this).attr("data-src") != ""){
				$(this).attr("src",$(this).attr("data-src"));
				$(this).attr("data-src","");
			}
			
		})
	}

	/*clear url from parameters*/
	if(window.history.pushState != undefined)
		window.history.pushState("", "", "index.html");
	
	
	
}

</script>


</head>

<body  data-appml-onload="appMLReady()" >

	<appml>
		
	</appml>
	 
</body>
</html> 





		